<div
  *ngIf="loading"
  class="col h-100 d-flex justify-content-center align-items-center loader-container"
>
  <div class="is-loader"></div>
  <h6 class="ml-2">Loading Sales</h6>
</div>
<div *ngIf="!loading">
<is-card>
  <is-card-header>
    <h4>Sales Report</h4>
  </is-card-header>
  <is-card-content>
    <div *ngIf="!loading; else loader" class="w-100">
      <div class="d-flex justify-content-end">
        <div class="d-flex align-items-center">
          <p class="mb-0 mr-2">From Date:</p>
          <is-datepicker [(ngModel)]="fromDate"></is-datepicker>
        </div>
        <div class="ml-2 d-flex align-items-center">
          <p class="mb-0 mr-2">To Date Date:</p>
          <is-datepicker [(ngModel)]="toDate"></is-datepicker>
        </div>
        <button class="ml-2" is-button type="button" (click)="onSearch()">Search</button>
      </div>
      <is-grid [value]="sales">
        <is-grid-column field="user" header="Order No." styleClass="text-dark">
          <ng-template let-sale="rowData" isGridTemplate="body">
            <span>{{sale.orderNo}}</span>
          </ng-template>
        </is-grid-column>
        <is-grid-column field="startTime" header="Order Date" styleClass="text-dark">
          <ng-template let-sale="rowData" isGridTemplate="body">
            <span>{{ sale.endTime | date }}</span>
          </ng-template>
        </is-grid-column>
        <is-grid-column field="discount" header="Discount" styleClass="text-dark">
          <ng-template let-sale="rowData" isGridTemplate="body">
            <span>{{ sale.discount }}</span>
          </ng-template>
        </is-grid-column>
        <is-grid-column field="total" header="Price" styleClass="text-dark">
          <ng-template let-sale="rowData" isGridTemplate="body">
            <span>{{ sale.total }}</span>
          </ng-template>
        </is-grid-column>
        <is-grid-column field="total" header="Total" styleClass="text-dark">
            <ng-template let-sale="rowData" isGridTemplate="body">
              <span>{{ sale.total - sale.discount }}</span>
            </ng-template>
          </is-grid-column>
      </is-grid>
      <div class="p-3 w-100">
        <div class="w-100 d-flex justify-content-end">
          <div class=" text-right" style="width: 150px;"><strong>Total: </strong></div>
          <div style="width: 150px;" class=" text-right" > {{total}}</div>
        </div>
        <div class="w-100 d-flex justify-content-end">
          <div class=" text-right" style="width: 150px;"><strong>Discount: </strong></div>
          <div style="width: 150px;" class=" text-right" > {{discount}}</div>
        </div>
        <div class="w-100 d-flex justify-content-end">
          <div class=" text-right" style="width: 150px;"><strong>Net Total: </strong></div>
          <div style="width: 150px;" class=" text-right" > {{netTotal}}</div>
        </div>
  
        <div class="w-100 d-flex justify-content-end">
          <div class=" text-right" style="width: 150px;"><strong>Commission: </strong></div>
          <div style="width: 150px;" class=" text-right" > {{sales[0].commission}}</div>
        </div>

        <div class="w-100 d-flex justify-content-end">
          <div class=" text-right" style="width: 150px;"><strong>Payable To SubQuch: </strong></div>
          <div style="width: 150px;" class=" text-right" > {{netTotal * (sales[0].commission / 100)}}</div>
        </div>
      </div>
    </div>
  </is-card-content>
</is-card>
</div>

<ng-template #loader>
  <div class="col min-content-height d-flex justify-content-center align-items-center loader-container">
    <div class="is-loader"></div>
  </div>
</ng-template>

<ng-template #noSales let-close="close" class="py-5">
  <div class="d-flex justify-content-center my-3">
    <h6>No Sales for the Last 30 Days</h6>
  </div>
  <div class="d-flex justify-content-center my-3">
      <button is-button (click)="close('ok')" style="width: 100px;">Ok</button>
    </div>
</ng-template>